<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implemented Simulators · POMDPs.jl</title><meta name="title" content="Implemented Simulators · POMDPs.jl"/><meta property="og:title" content="Implemented Simulators · POMDPs.jl"/><meta property="twitter:title" content="Implemented Simulators · POMDPs.jl"/><meta name="description" content="Documentation for POMDPs.jl."/><meta property="og:description" content="Documentation for POMDPs.jl."/><meta property="twitter:description" content="Documentation for POMDPs.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="POMDPs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">POMDPs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../">POMDPs.jl</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../get_started/">Getting Started</a></li><li><a class="tocitem" href="../../concepts/">Concepts and Architecture</a></li></ul></li><li><span class="tocitem">Defining (PO)MDP Models</span><ul><li><a class="tocitem" href="../../def_pomdp/">Defining POMDPs and MDPs</a></li><li><a class="tocitem" href="../../interfaces/">Spaces and Distributions</a></li></ul></li><li><span class="tocitem">Writing Solvers</span><ul><li><a class="tocitem" href="../../def_solver/">Solvers</a></li><li><a class="tocitem" href="../../offline_solver/">Example: Defining an offline solver</a></li><li><a class="tocitem" href="../../online_solver/">Example: Defining an online solver</a></li></ul></li><li><span class="tocitem">Writing Belief Updaters</span><ul><li><a class="tocitem" href="../../def_updater/">Defining a Belief Updater</a></li></ul></li><li><span class="tocitem">Analyzing Results</span><ul><li><a class="tocitem" href="../../simulation/">Simulation Standard</a></li><li><a class="tocitem" href="../../run_simulation/">Running Simulations</a></li><li><a class="tocitem" href="../../policy_interaction/">Interacting with Policies</a></li></ul></li><li><span class="tocitem">Examples and Gallery</span><ul><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../example_defining_problems/">Defining a POMDP</a></li><li><a class="tocitem" href="../../example_solvers/">Using Different Solvers</a></li><li><a class="tocitem" href="../../example_simulations/">Simulations Examples</a></li><li><a class="tocitem" href="../../example_gridworld_mdp/">GridWorld MDP Tutorial</a></li><li><a class="tocitem" href="../../gallery/">Gallery of POMDPs.jl Problems</a></li></ul></li><li><span class="tocitem">POMDPTools</span><ul><li><a class="tocitem" href="../">POMDPTools: the standard library for POMDPs.jl</a></li><li><a class="tocitem" href="../distributions/">Implemented Distributions</a></li><li><a class="tocitem" href="../model/">Model Tools</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../beliefs/">Implemented Belief Updaters</a></li><li><a class="tocitem" href="../policies/">Implemented Policies</a></li><li class="is-active"><a class="tocitem" href>Implemented Simulators</a><ul class="internal"><li><a class="tocitem" href="#which_simulator"><span>Which Simulator Should I Use?</span></a></li><li><a class="tocitem" href="#Stepping-through"><span>Stepping through</span></a></li><li><a class="tocitem" href="#Rollouts"><span>Rollouts</span></a></li><li><a class="tocitem" href="#History-Recorder"><span>History Recorder</span></a></li><li><a class="tocitem" href="#sim-function"><span><code>sim()</code></span></a></li><li><a class="tocitem" href="#Histories"><span>Histories</span></a></li><li><a class="tocitem" href="#Parallel"><span>Parallel</span></a></li><li><a class="tocitem" href="#Display"><span>Display</span></a></li></ul></li><li><a class="tocitem" href="../common_rl/">CommonRLInterface Integration</a></li><li><a class="tocitem" href="../testing/">Testing</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../../api/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">POMDPTools</a></li><li class="is-active"><a href>Implemented Simulators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implemented Simulators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/POMDPs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/master/docs/src/POMDPTools/simulators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Implemented-Simulators"><a class="docs-heading-anchor" href="#Implemented-Simulators">Implemented Simulators</a><a id="Implemented-Simulators-1"></a><a class="docs-heading-anchor-permalink" href="#Implemented-Simulators" title="Permalink"></a></h1><p>POMDPTools contains a collection of POMDPs.jl simulators.</p><p>Usage examples can be found in the <a href="../../example_simulations/#Simulations-Examples">Simulations Examples</a> section.</p><p>If you are just getting started, probably the easiest way to begin is the <a href="#Stepping-through"><code>stepthrough</code> function</a>. Otherwise, consult the <a href="#which_simulator">Which Simulator Should I Use?</a> guide below:</p><h2 id="which_simulator"><a class="docs-heading-anchor" href="#which_simulator">Which Simulator Should I Use?</a><a id="which_simulator-1"></a><a class="docs-heading-anchor-permalink" href="#which_simulator" title="Permalink"></a></h2><p>The simulators in this package provide interaction with simulations of MDP and POMDP environments from a variety of perspectives. Use these questions to choose the best simulator to suit your needs.</p><h3 id="I-want-to-run-fast-rollout-simulations-and-get-the-discounted-reward."><a class="docs-heading-anchor" href="#I-want-to-run-fast-rollout-simulations-and-get-the-discounted-reward.">I want to run fast rollout simulations and get the discounted reward.</a><a id="I-want-to-run-fast-rollout-simulations-and-get-the-discounted-reward.-1"></a><a class="docs-heading-anchor-permalink" href="#I-want-to-run-fast-rollout-simulations-and-get-the-discounted-reward." title="Permalink"></a></h3><p>Use the <a href="#Rollouts">Rollout Simulator</a>.</p><h3 id="I-want-to-evaluate-performance-with-many-parallel-Monte-Carlo-simulations."><a class="docs-heading-anchor" href="#I-want-to-evaluate-performance-with-many-parallel-Monte-Carlo-simulations.">I want to evaluate performance with many parallel Monte Carlo simulations.</a><a id="I-want-to-evaluate-performance-with-many-parallel-Monte-Carlo-simulations.-1"></a><a class="docs-heading-anchor-permalink" href="#I-want-to-evaluate-performance-with-many-parallel-Monte-Carlo-simulations." title="Permalink"></a></h3><p>Use the <a href="#Parallel">Parallel Simulator</a>.</p><h3 id="I-want-to-closely-examine-the-histories-of-states,-actions,-etc.-produced-by-simulations."><a class="docs-heading-anchor" href="#I-want-to-closely-examine-the-histories-of-states,-actions,-etc.-produced-by-simulations.">I want to closely examine the histories of states, actions, etc. produced by simulations.</a><a id="I-want-to-closely-examine-the-histories-of-states,-actions,-etc.-produced-by-simulations.-1"></a><a class="docs-heading-anchor-permalink" href="#I-want-to-closely-examine-the-histories-of-states,-actions,-etc.-produced-by-simulations." title="Permalink"></a></h3><p>Use the <a href="#History-Recorder">History Recorder</a>.</p><h3 id="I-want-to-step-through-each-individual-step-of-a-simulation."><a class="docs-heading-anchor" href="#I-want-to-step-through-each-individual-step-of-a-simulation.">I want to step through each individual step of a simulation.</a><a id="I-want-to-step-through-each-individual-step-of-a-simulation.-1"></a><a class="docs-heading-anchor-permalink" href="#I-want-to-step-through-each-individual-step-of-a-simulation." title="Permalink"></a></h3><p>Use the <a href="#Stepping-through"><code>stepthrough</code> function</a>.</p><h3 id="I-want-to-visualize-a-simulation."><a class="docs-heading-anchor" href="#I-want-to-visualize-a-simulation.">I want to visualize a simulation.</a><a id="I-want-to-visualize-a-simulation.-1"></a><a class="docs-heading-anchor-permalink" href="#I-want-to-visualize-a-simulation." title="Permalink"></a></h3><p>Use the <a href="#Display"><code>DisplaySimulator</code></a>.</p><p>Also see the <a href="https://github.com/JuliaPOMDP/POMDPGifs.jl">POMDPGifs package</a> for creating gif animations.</p><h3 id="I-want-to-interact-with-a-MDP-or-POMDP-environment-from-the-policy&#39;s-perspective"><a class="docs-heading-anchor" href="#I-want-to-interact-with-a-MDP-or-POMDP-environment-from-the-policy&#39;s-perspective">I want to interact with a MDP or POMDP environment from the policy&#39;s perspective</a><a id="I-want-to-interact-with-a-MDP-or-POMDP-environment-from-the-policy&#39;s-perspective-1"></a><a class="docs-heading-anchor-permalink" href="#I-want-to-interact-with-a-MDP-or-POMDP-environment-from-the-policy&#39;s-perspective" title="Permalink"></a></h3><p>Use the <a href="#sim-function"><code>sim</code> function</a>.</p><h2 id="Stepping-through"><a class="docs-heading-anchor" href="#Stepping-through">Stepping through</a><a id="Stepping-through-1"></a><a class="docs-heading-anchor-permalink" href="#Stepping-through" title="Permalink"></a></h2><p>The <a href="#POMDPTools.Simulators.stepthrough"><code>stepthrough</code></a> function exposes a simulation as an iterator so that the steps can be iterated through with a for loop syntax as follows:</p><pre><code class="language-julia hljs">pomdp = BabyPOMDP()
policy = RandomPolicy(pomdp)

for (s, a, o, r) in stepthrough(pomdp, policy, &quot;s,a,o,r&quot;, max_steps=10)
    println(&quot;in state $s&quot;)
    println(&quot;took action $a&quot;)
    println(&quot;received observation $o and reward $r&quot;)
end</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.stepthrough" href="#POMDPTools.Simulators.stepthrough"><code>POMDPTools.Simulators.stepthrough</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stepthrough(problem, policy, [spec])
stepthrough(problem, policy, [spec], [rng=rng], [max_steps=max_steps])
stepthrough(mdp::MDP, policy::Policy, [init_state], [spec]; [kwargs...])
stepthrough(pomdp::POMDP, policy::Policy, [up::Updater, [initial_belief, [initial_state]]], [spec]; [kwargs...])</code></pre><p>Create a simulation iterator. This is intended to be used with for loop syntax to output the results of each step <em>as the simulation is being run</em>. </p><p>Example:</p><pre><code class="nohighlight hljs">pomdp = BabyPOMDP()
policy = RandomPolicy(pomdp)

for (s, a, o, r) in stepthrough(pomdp, policy, &quot;s,a,o,r&quot;, max_steps=10)
    println(&quot;in state $s&quot;)
    println(&quot;took action $a&quot;)
    println(&quot;received observation $o and reward $r&quot;)
end</code></pre><p>The optional <code>spec</code> argument can be a string, tuple of symbols, or single symbol and follows the same pattern as <a href="#eachstep"><code>eachstep</code></a> called on a <code>SimHistory</code> object.</p><p>Under the hood, this function creates a <code>StepSimulator</code> with <code>spec</code> and returns a <code>[PO]MDPSimIterator</code> by calling simulate with all of the arguments except <code>spec</code>. All keyword arguments are passed to the <code>StepSimulator</code> constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/stepthrough.jl#L158-L180">source</a></section></article><p>The <code>StepSimulator</code> contained in this file can provide the same functionality with the following syntax:</p><pre><code class="language-julia hljs">sim = StepSimulator(&quot;s,a,r,sp&quot;)
for (s,a,r,sp) in simulate(sim, problem, policy)
    # do something
end</code></pre><h2 id="Rollouts"><a class="docs-heading-anchor" href="#Rollouts">Rollouts</a><a id="Rollouts-1"></a><a class="docs-heading-anchor-permalink" href="#Rollouts" title="Permalink"></a></h2><p><code>RolloutSimulator</code> is the simplest MDP or POMDP simulator. When <code>simulate</code> is called, it simply simulates a single trajectory of the process and returns the discounted reward.</p><pre><code class="language-julia hljs">rs = RolloutSimulator()
mdp = GridWorld()
policy = RandomPolicy(mdp)

r = simulate(rs, mdp, policy)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.RolloutSimulator" href="#POMDPTools.Simulators.RolloutSimulator"><code>POMDPTools.Simulators.RolloutSimulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RolloutSimulator(rng, max_steps)
RolloutSimulator(; &lt;keyword arguments&gt;)</code></pre><p>A fast simulator that just returns the reward</p><p>The simulation will be terminated when either</p><ol><li>a terminal state is reached (as determined by <code>isterminal()</code> or</li><li>the discount factor is as small as <code>eps</code> or</li><li>max_steps have been executed</li></ol><p><strong>Keyword arguments:</strong></p><ul><li>rng::AbstractRNG (default: Random.default_rng()) - A random number generator to use. </li><li>eps::Float64 (default: 0.0) - A small number; if γᵗ where γ is the discount factor and t is the time step becomes smaller than this, the simulation will be terminated.</li><li>max_steps::Int (default: typemax(Int)) - The maximum number of steps to simulate.</li></ul><p><strong>Usage (optional arguments in brackets):</strong></p><pre><code class="nohighlight hljs">ro = RolloutSimulator()
history = simulate(ro, pomdp, policy, [updater [, init_belief [, init_state]]])</code></pre><p>See also: <a href="#POMDPTools.Simulators.HistoryRecorder"><code>HistoryRecorder</code></a>, <a href="#POMDPTools.Simulators.run_parallel"><code>run_parallel</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/rollout.jl#L4-L26">source</a></section></article><h2 id="History-Recorder"><a class="docs-heading-anchor" href="#History-Recorder">History Recorder</a><a id="History-Recorder-1"></a><a class="docs-heading-anchor-permalink" href="#History-Recorder" title="Permalink"></a></h2><p>A <code>HistoryRecorder</code> runs a simulation and records the trajectory. It returns an <code>AbstractVector</code> of <code>NamedTuples</code> - see <a href="#Histories">Histories</a> for more info.</p><pre><code class="language-julia hljs">hr = HistoryRecorder(max_steps=100)
pomdp = TigerPOMDP()
policy = RandomPolicy(pomdp)

h = simulate(hr, pomdp, policy)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.HistoryRecorder" href="#POMDPTools.Simulators.HistoryRecorder"><code>POMDPTools.Simulators.HistoryRecorder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A simulator that records the history for later examination</p><p>The simulation will be terminated when either</p><ol><li>a terminal state is reached (as determined by <code>isterminal()</code> or</li><li>the discount factor is as small as <code>eps</code> or</li><li>max_steps have been executed</li></ol><p>Keyword Arguments:     - <code>rng</code>: The random number generator for the simulation     - <code>capture_exception::Bool</code>: whether to capture an exception and store it in the history, or let it go uncaught, potentially killing the script     - <code>show_progress::Bool</code>: show a progress bar for the simulation     - <code>eps</code>     - <code>max_steps</code></p><p>Usage (optional arguments in brackets):</p><pre><code class="nohighlight hljs">hr = HistoryRecorder()
history = simulate(hr, pomdp, policy, [updater [, init_belief [, init_state]]])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/history_recorder.jl#L4-L23">source</a></section></article><h2 id="sim-function"><a class="docs-heading-anchor" href="#sim-function"><code>sim()</code></a><a id="sim-function-1"></a><a class="docs-heading-anchor-permalink" href="#sim-function" title="Permalink"></a></h2><p>The <code>sim</code> function provides a convenient way to interact with a POMDP or MDP environment and return a <a href="#Histories">history</a>. The first argument is a function that is called at every time step and takes a state (in the case of an MDP) or an observation (in the case of a POMDP) as the argument and then returns an action. The second argument is a pomdp or mdp. It is intended to be used with Julia&#39;s <a href="https://docs.julialang.org/en/v1/manual/functions/#Do-Block-Syntax-for-Function-Arguments-1"><code>do</code> syntax</a> as follows:</p><pre><code class="language-julia hljs">pomdp = TigerPOMDP()
history = sim(pomdp, max_steps=10) do obs
    println(&quot;Observation was $obs.&quot;)
    return TIGER_OPEN_LEFT
end</code></pre><p>This allows a flexible and general way to interact with a POMDP environment without creating new <code>Policy</code> types.</p><p>In the POMDP case, an updater can optionally be supplied as an additional positional argument if the policy function works with beliefs rather than directly with observations.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.sim" href="#POMDPTools.Simulators.sim"><code>POMDPTools.Simulators.sim</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sim(polfunc::Function, mdp::MDP; [&lt;keyword arguments&gt;])
sim(polfunc::Function, pomdp::POMDP; [&lt;keyword arguments&gt;])</code></pre><p>Alternative way of running a simulation with a function specifying how to calculate the action at each timestep.</p><p><strong>Usage</strong></p><pre><code class="nohighlight hljs">sim(mdp) do s
    # code that calculates action `a` based on `s` - this is the policy
    # you can also do other things like display something
    return a
end</code></pre><p>for an MDP or</p><pre><code class="nohighlight hljs">sim(pomdp) do o
    # code that calculates &#39;a&#39; based on observation `o`
    # optionally you could save &#39;o&#39; in a global variable or do a belief update
    return a
end</code></pre><p>or with a POMDP</p><pre><code class="nohighlight hljs">sim(pomdp, updater) do b
    # code that calculates &#39;a&#39; based on belief `b`
    # `b` is calculated by `updater`
    return a
end</code></pre><p>for a POMDP and a belief updater.</p><p><strong>Keyword Arguments</strong></p><p><strong>All Versions</strong></p><ul><li><code>initialstate</code>: the initial state for the simulation</li><li><code>simulator</code>: keyword argument to specify any simulator to run the simulation. If nothing is specified for the simulator, a HistoryRecorder will be used as the simulator, with all keyword arguments forwarded to it, e.g.<pre><code class="nohighlight hljs">sim(mdp, max_steps=100, show_progress=true) do s
    # ...
end</code></pre>will limit the simulation to 100 steps.</li></ul><p><strong>POMDP version</strong></p><ul><li><code>initialobs</code>: this will control the initial observation given to the policy function. If this is not defined, <code>rand(initialobs(m, s))</code> will be used if it is available. If it is not, <code>missing</code> will be used.</li></ul><p><strong>POMDP and updater version</strong></p><ul><li><code>initialbelief</code>: <code>initialize_belief(updater, initialbelief)</code> is the first belief that will be given to the policy function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/sim.jl#L4-L56">source</a></section></article><h2 id="Histories"><a class="docs-heading-anchor" href="#Histories">Histories</a><a id="Histories-1"></a><a class="docs-heading-anchor-permalink" href="#Histories" title="Permalink"></a></h2><p>The results produced by <a href="#POMDPTools.Simulators.HistoryRecorder"><code>HistoryRecorder</code></a>s and the <a href="#POMDPTools.Simulators.sim"><code>sim</code></a> function are contained in <code>SimHistory</code> objects.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.SimHistory" href="#POMDPTools.Simulators.SimHistory"><code>POMDPTools.Simulators.SimHistory</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimHistory</code></pre><p>An (PO)MDP simulation history returned by <code>simulate(::HistoryRecorder, ::Union{MDP,POMDP},...)</code>.</p><p>This is an <code>AbstractVector</code> of <a href="https://docs.julialang.org/en/v1/manual/types/index.html#Named-Tuple-Types-1"><code>NamedTuples</code></a> containing the states, actions, etc.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">hist[1][:s] # returns the first state in the history</code></pre><pre><code class="nohighlight hljs">hist[:a] # returns all of the actions in the history</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/history.jl#L9-L23">source</a></section></article><h3 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h3><pre><code class="language-julia hljs">using POMDPs, POMDPTools, POMDPModels
hr = HistoryRecorder(max_steps=10)
hist = simulate(hr, BabyPOMDP(), FunctionPolicy(x-&gt;true))
step = hist[1] # all information available about the first step
step[:s] # the first state
step[:a] # the first action</code></pre><p>To see everything available in a step, use</p><pre><code class="language-julia hljs">keys(first(hist))</code></pre><p>The entire history of each variable is available by using a <code>Symbol</code> instead of an index, i.e.</p><pre><code class="language-julia hljs">hist[:s]</code></pre><p>will return a vector of the starting states for each step (note the difference between <code>:s</code> and <code>:sp</code>).</p><h3 id="eachstep"><a class="docs-heading-anchor" href="#eachstep"><code>eachstep</code></a><a id="eachstep-1"></a><a class="docs-heading-anchor-permalink" href="#eachstep" title="Permalink"></a></h3><p>The <a href="#eachstep"><code>eachstep</code></a> function may also be useful:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.eachstep" href="#POMDPTools.Simulators.eachstep"><code>POMDPTools.Simulators.eachstep</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">for t in eachstep(hist, [spec])
    ...
end</code></pre><p>Iterate through the steps in <code>SimHistory</code> <code>hist</code>. <code>spec</code> is a tuple of symbols or string that controls what is returned for each step.</p><p>For example,</p><pre><code class="language-julia hljs">for (s, a, r, sp) in eachstep(h, &quot;(s, a, r, sp)&quot;)    
    println(&quot;reward $r received when state $sp was reached after action $a was taken in state $s&quot;)
end</code></pre><p>returns the start state, action, reward and destination state for each step of the simulation.</p><p>Alternatively, instead of expanding the steps implicitly, the elements of the step can be accessed as fields (since each step is a <code>NamedTuple</code>):</p><pre><code class="language-julia hljs">for step in eachstep(h, &quot;(s, a, r, sp)&quot;)    
    println(&quot;reward $(step.r) received when state $(step.sp) was reached after action $(step.a) was taken in state $(step.s)&quot;)
end</code></pre><p>The possible valid elements in the iteration specification are</p><ul><li>Any node in the (PO)MDP Dynamic Decision network (by default <code>:s</code>, <code>:a</code>, <code>:sp</code>, <code>:o</code>, <code>:r</code>)</li><li><code>b</code> - the initial belief in the step (for POMDPs only)</li><li><code>bp</code> - the belief after being updated based on <code>o</code> (for POMDPs only)</li><li><code>action_info</code> - info from the policy decision (from <code>action_info</code>)</li><li><code>update_info</code> - info from the belief update (from <code>update_info</code>)</li><li><code>t</code> - the timestep index</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/history.jl#L96-L125">source</a></section></article><h4 id="Examples:"><a class="docs-heading-anchor" href="#Examples:">Examples:</a><a id="Examples:-1"></a><a class="docs-heading-anchor-permalink" href="#Examples:" title="Permalink"></a></h4><pre><code class="language-julia hljs">collect(eachstep(h, &quot;a,o&quot;))</code></pre><p>will produce a vector of action-observation named tuples.</p><pre><code class="language-julia hljs">collect(norm(sp-s) for (s,sp) in eachstep(h, &quot;s,sp&quot;))</code></pre><p>will produce a vector of the distances traveled on each step (assuming the state is a Euclidean vector).</p><h4 id="Notes"><a class="docs-heading-anchor" href="#Notes">Notes</a><a id="Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Notes" title="Permalink"></a></h4><ul><li>The iteration specification can be specified as a tuple of symbols (e.g. <code>(:s, :a)</code>) instead of a string.</li><li>For type stability in performance-critical code, one should construct an iterator directly using <code>HistoryIterator{typeof(h), (:a,:r)}(h)</code> rather than <code>eachstep(h, &quot;ar&quot;)</code>.</li></ul><h3 id="Other-Functions"><a class="docs-heading-anchor" href="#Other-Functions">Other Functions</a><a id="Other-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Functions" title="Permalink"></a></h3><p><code>state_hist(h)</code>, <code>action_hist(h)</code>, <code>observation_hist(h)</code> <code>belief_hist(h)</code>, and <code>reward_hist(h)</code> will return vectors of the states, actions, and rewards, and <code>undiscounted_reward(h)</code> and <code>discounted_reward(h)</code> will return the total rewards collected over the trajectory. <code>n_steps(h)</code> returns the number of steps in the history. <code>exception(h)</code> and <code>backtrace(h)</code> can be used to hold an exception if the simulation failed to finish.</p><p><code>view(h, range)</code> (e.g. <code>view(h, 1:n_steps(h)-4)</code>) can be used to create a view of the history object <code>h</code> that only contains a certain range of steps. The object returned by <code>view</code> is an <code>AbstractSimHistory</code> that can be iterated through and manipulated just like a complete <code>SimHistory</code>.</p><h2 id="Parallel"><a class="docs-heading-anchor" href="#Parallel">Parallel</a><a id="Parallel-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel" title="Permalink"></a></h2><p>POMDPTools contains a utility for running many Monte Carlo simulations in parallel to evaluate performance. The basic workflow involves the following steps:</p><ol><li>Create a vector of <a href="#POMDPTools.Simulators.Sim"><code>Sim</code></a> objects, each specifying how a single simulation should be run.</li><li>Use the <a href="#POMDPTools.Simulators.run_parallel"><code>run_parallel</code></a> or <a href="#Base.run"><code>run</code></a> function to run the simulations.</li><li>Analyze the results of the simulations contained in the <a href="https://github.com/JuliaData/DataFrames.jl"><code>DataFrame</code></a> returned by <a href="#POMDPTools.Simulators.run_parallel"><code>run_parallel</code></a>.</li></ol><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>An example can be found in the <a href="../../example_simulations/#Parallel-Simulations">Parallel Simulations</a> section.</p><h3 id="Sim-objects"><a class="docs-heading-anchor" href="#Sim-objects">Sim objects</a><a id="Sim-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Sim-objects" title="Permalink"></a></h3><p>Each simulation should be specified by a <a href="#POMDPTools.Simulators.Sim"><code>Sim</code></a> object which contains all the information needed to run a simulation, including the <code>Simulator</code>, <code>POMDP</code> or <code>MDP</code>, <code>Policy</code>, <code>Updater</code>, and any other ingredients.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.Sim" href="#POMDPTools.Simulators.Sim"><code>POMDPTools.Simulators.Sim</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Sim(m::MDP, p::Policy[, initialstate]; kwargs...)
Sim(m::POMDP, p::Policy[, updater[, initial_belief[, initialstate]]]; kwargs...)</code></pre><p>Create a Sim object that contains everything needed to run and record a single simulation, including model, initial conditions, and metadata.</p><p>A vector of <code>Sim</code> objects can be executed with <a href="#Base.run"><code>run</code></a> or <a href="#POMDPTools.Simulators.run_parallel"><code>run_parallel</code></a>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>rng::AbstractRNG=Random.default_rng()</code></li><li><code>max_steps::Int=typemax(Int)</code></li><li><code>simulator::Simulator=HistoryRecorder(rng=rng, max_steps=max_steps)</code></li><li><code>metadata::NamedTuple a named tuple (or dictionary) of metadata for the sim that will be recorded, e.g.</code>(solver_iterations=500,)`.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/parallel.jl#L1-L14">source</a></section></article><h3 id="Running-simulations"><a class="docs-heading-anchor" href="#Running-simulations">Running simulations</a><a id="Running-simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Running-simulations" title="Permalink"></a></h3><p>The simulations are actually carried out by the <code>run</code> and <code>run_parallel</code> functions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.run_parallel" href="#POMDPTools.Simulators.run_parallel"><code>POMDPTools.Simulators.run_parallel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_parallel(queue::Vector{Sim})
run_parallel(f::Function, queue::Vector{Sim})</code></pre><p>Run <code>Sim</code> objects in <code>queue</code> in parallel and return results as a <code>DataFrame</code>.</p><p>By default, the <code>DataFrame</code> will contain the reward for each simulation and the metadata provided to the sim.</p><p><strong>Arguments</strong></p><ul><li><code>queue</code>: List of <code>Sim</code> objects to be executed</li><li><code>f</code>: Function to process the results of each simulation</li></ul><p>This function should take two arguments, (1) the <code>Sim</code> that was executed and (2) the result of the simulation, by default a <code>SimHistory</code>. It should return a named tuple that will appear in the dataframe. See Examples below.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>show_progress::Bool</code>: whether or not to show a progress meter</li><li><code>progress::ProgressMeter.Progress</code>: determines how the progress meter is displayed</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">run_parallel(queue) do sim, hist
    return (n_steps=n_steps(hist), reward=discounted_reward(hist))
end</code></pre><p>will return a dataframe with with the number of steps and the reward in it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/parallel.jl#L95-L120">source</a></section></article><p>The <code>run</code> function is also provided to run simulations in serial (this is often useful for debugging). Note that the documentation below also contains a section for the builtin julia <code>run</code> function, even though it is not relevant here.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.run" href="#Base.run"><code>Base.run</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run(queue::Vector{Sim})
run(f::Function, queue::Vector{Sim})</code></pre><p>Run the <code>Sim</code> objects in <code>queue</code> on a single process and return the results as a dataframe.</p><p>See <code>run_parallel</code> for more information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/parallel.jl#L155-L162">source</a></section></article><h3 id="Specifying-information-to-be-recorded"><a class="docs-heading-anchor" href="#Specifying-information-to-be-recorded">Specifying information to be recorded</a><a id="Specifying-information-to-be-recorded-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-information-to-be-recorded" title="Permalink"></a></h3><p>By default, only the discounted rewards from each simulation are recorded, but arbitrary information can be recorded.</p><p>The <a href="#POMDPTools.Simulators.run_parallel"><code>run_parallel</code></a> and <a href="#Base.run"><code>run</code></a> functions accept a function (normally specified via the <a href="https://docs.julialang.org/en/v1/manual/functions/#Do-Block-Syntax-for-Function-Arguments-1"><code>do</code> syntax</a>) that takes the <a href="#POMDPTools.Simulators.Sim"><code>Sim</code></a> object and <a href="#Histories">history</a> of the simulation and extracts relevant statistics as a named tuple. For example, if the desired characteristics are the number of steps in the simulation and the reward, <a href="#POMDPTools.Simulators.run_parallel"><code>run_parallel</code></a> would be invoked as follows:</p><pre><code class="language-julia hljs">df = run_parallel(queue) do sim::Sim, hist::SimHistory
    return (n_steps=n_steps(hist), reward=discounted_reward(hist))
end</code></pre><p>These statistics are combined into a <a href="https://github.com/JuliaData/DataFrames.jl"><code>DataFrame</code></a>, with each line representing a single simulation, allowing for statistical analysis. For example,</p><pre><code class="language-julia hljs">mean(df[:reward]./df[:n_steps])</code></pre><p>would compute the average reward per step with each simulation weighted equally regardless of length.</p><h2 id="Display"><a class="docs-heading-anchor" href="#Display">Display</a><a id="Display-1"></a><a class="docs-heading-anchor-permalink" href="#Display" title="Permalink"></a></h2><h3 id="DisplaySimulator"><a class="docs-heading-anchor" href="#DisplaySimulator"><code>DisplaySimulator</code></a><a id="DisplaySimulator-1"></a><a class="docs-heading-anchor-permalink" href="#DisplaySimulator" title="Permalink"></a></h3><p>The <code>DisplaySimulator</code> displays each step of a simulation in real time through a multimedia display such as a Jupyter notebook or <a href="https://github.com/queryverse/ElectronDisplay.jl">ElectronDisplay</a>. Specifically it uses <a href="../visualization/#POMDPTools.ModelTools.render"><code>POMDPTools.render</code></a> and the built-in Julia <a href="https://docs.julialang.org/en/v1/base/io-network/#Base.Multimedia.display"><code>display</code> function</a> to visualize each step.</p><p>Example:</p><pre><code class="language-julia hljs">using POMDPs
using POMDPModels
using POMDPTools
using ElectronDisplay
ElectronDisplay.CONFIG.single_window = true

ds = DisplaySimulator()
m = SimpleGridWorld()
simulate(ds, m, RandomPolicy(m))</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="POMDPTools.Simulators.DisplaySimulator" href="#POMDPTools.Simulators.DisplaySimulator"><code>POMDPTools.Simulators.DisplaySimulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DisplaySimulator(;kwargs...)</code></pre><p>Create a simulator that displays each step of a simulation.</p><p>Given a POMDP or MDP model <code>m</code>, this simulator roughly works like</p><pre><code class="nohighlight hljs">for step in stepthrough(m, ...)
    display(render(m, step))
end</code></pre><p><strong>Keyword Arguments</strong></p><ul><li><code>display::AbstractDisplay</code>: the display to use for the first argument to the <code>display</code> function. If this is <code>nothing</code>, <code>display(...)</code> will be called without an <code>AbstractDisplay</code> argument.</li><li><code>render_kwargs::NamedTuple</code>: keyword arguments for <code>POMDPTools.render(...)</code></li><li><code>max_fps::Number=10</code>: maximum number of frames to be displayed per second - <code>sleep</code> will be used to skip extra time, so this is not designed for high precision</li><li><code>predisplay::Function</code>: function to call before every call to <code>display(...)</code>. The only argument to this function will be the display (if it is specified) or <code>nothing</code></li><li><code>extra_initial::Bool=false</code>: if <code>true</code>, display an extra step at the beginning with only elements <code>t</code>, <code>sp</code>, and <code>bp</code> for POMDPs (this can be useful to see the initial state if <code>render</code> displays only <code>sp</code> and not <code>s</code>).</li><li><code>extra_final</code>::Bool=true<code>: if</code>true<code>, display an extra step at the end with only elements</code>t<code>,</code>done<code>,</code>s<code>, and</code>b<code>for POMDPs (this can be useful to see the final state if</code>render<code>displays only</code>s<code>and not</code>sp`).</li><li><code>max_steps::Integer</code>: maximum number of steps to run for</li><li><code>spec::NTuple{Symbol}</code>: specification of what step elements to display (see <code>eachstep</code>)</li><li><code>rng::AbstractRNG</code>: random number generator</li></ul><p>See the POMDPSimulators documentation for more tips about using specific displays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/a14d1f3d2e1f551e154803064bc9496a0df4ba3e/lib/POMDPTools/src/Simulators/display.jl#L11-L34">source</a></section></article><h3 id="Display-specific-tips"><a class="docs-heading-anchor" href="#Display-specific-tips">Display-specific tips</a><a id="Display-specific-tips-1"></a><a class="docs-heading-anchor-permalink" href="#Display-specific-tips" title="Permalink"></a></h3><p>The following tips may be helpful when using particular displays.</p><h4 id="Jupyter-notebooks"><a class="docs-heading-anchor" href="#Jupyter-notebooks">Jupyter notebooks</a><a id="Jupyter-notebooks-1"></a><a class="docs-heading-anchor-permalink" href="#Jupyter-notebooks" title="Permalink"></a></h4><p>By default, in a Jupyter notebook, the visualizations of all steps are displayed in the output box one after another. To make the output animated instead, where the image is overwritten at each step, one may use</p><pre><code class="language-julia hljs">DisplaySimulator(predisplay=(d)-&gt;IJulia.clear_output(true))</code></pre><h4 id="ElectronDisplay"><a class="docs-heading-anchor" href="#ElectronDisplay">ElectronDisplay</a><a id="ElectronDisplay-1"></a><a class="docs-heading-anchor-permalink" href="#ElectronDisplay" title="Permalink"></a></h4><p>By default, ElectronDisplay will open a new window for each new step. To prevent this, use</p><pre><code class="language-julia hljs">ElectronDisplay.CONFIG.single_window = true</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../policies/">« Implemented Policies</a><a class="docs-footer-nextpage" href="../common_rl/">CommonRLInterface Integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 24 November 2024 23:43">Sunday 24 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
