<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation Standard · POMDPs.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="POMDPs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">POMDPs.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../">POMDPs.jl</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../get_started/">Getting Started</a></li><li><a class="tocitem" href="../concepts/">Concepts and Architecture</a></li></ul></li><li><span class="tocitem">Defining (PO)MDP Models</span><ul><li><a class="tocitem" href="../def_pomdp/">Defining POMDPs and MDPs</a></li><li><a class="tocitem" href="../static/">Defining Static (PO)MDP Properties</a></li><li><a class="tocitem" href="../interfaces/">Spaces and Distributions</a></li><li><a class="tocitem" href="../dynamics/">Defining (PO)MDP Dynamics</a></li></ul></li><li><span class="tocitem">Writing Solvers</span><ul><li><a class="tocitem" href="../def_solver/">Solvers</a></li><li><a class="tocitem" href="../offline_solver/">Example: Defining an offline solver</a></li><li><a class="tocitem" href="../online_solver/">Example: Defining an online solver</a></li></ul></li><li><span class="tocitem">Writing Belief Updaters</span><ul><li><a class="tocitem" href="../def_updater/">Defining a Belief Updater</a></li></ul></li><li><span class="tocitem">Analyzing Results</span><ul><li class="is-active"><a class="tocitem" href>Simulation Standard</a><ul class="internal"><li><a class="tocitem" href="#POMDP-Simulation"><span>POMDP Simulation</span></a></li><li><a class="tocitem" href="#MDP-Simulation"><span>MDP Simulation</span></a></li></ul></li><li><a class="tocitem" href="../run_simulation/">Running Simulations</a></li><li><a class="tocitem" href="../policy_interaction/">Interacting with Policies</a></li></ul></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../api/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Analyzing Results</a></li><li class="is-active"><a href>Simulation Standard</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulation Standard</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaPOMDP/POMDPs.jl/blob/master/docs/src/simulation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulation-Standard"><a class="docs-heading-anchor" href="#Simulation-Standard">Simulation Standard</a><a id="Simulation-Standard-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Standard" title="Permalink"></a></h1><p>Important note: In most cases, <strong>users need not implement their own simulators</strong>. Several simulators that are compatible with the standard in this document are implemented in the <a href="https://github.com/JuliaPOMDP/POMDPSimulators.jl">POMDPSimulators package</a> and allow <a href="https://juliapomdp.github.io/POMDPSimulators.jl/latest/which.html#Which-Simulator-Should-I-Use?-1">interaction from a variety of perspectives</a>. Moreover <a href="https://github.com/JuliaPOMDP/RLInterface.jl">RLInterface.jl</a> provides an OpenAI Gym style environment interface to interact with environments that is more flexible in some cases.</p><p>In order to maintain consistency across the POMDPs.jl ecosystem, this page defines a standard for how simulations should be conducted. All simulators should be consistent with this page, and, if solvers are attempting to find an optimal POMDP policy, they should optimize the expected value of <code>r_total</code> below. In particular, this page should be consulted when questions about how less-obvious concepts like terminal states are handled.</p><h2 id="POMDP-Simulation"><a class="docs-heading-anchor" href="#POMDP-Simulation">POMDP Simulation</a><a id="POMDP-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#POMDP-Simulation" title="Permalink"></a></h2><h3 id="Inputs"><a class="docs-heading-anchor" href="#Inputs">Inputs</a><a id="Inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs" title="Permalink"></a></h3><p>In general, POMDP simulations take up to 5 inputs (see also the <a href="../api/#POMDPs.simulate"><code>simulate</code></a> docstring):</p><ul><li><code>pomdp::POMDP</code>: pomdp model object (see <a href="../concepts/#POMDPs-and-MDPs">POMDPs and MDPs</a>)</li><li><code>policy::Policy</code>: policy (see <a href="../concepts/#Solvers-and-Policies">Solvers and Policies</a>)</li><li><code>up::Updater</code>: belief updater (see <a href="../concepts/#Beliefs-and-Updaters">Beliefs and Updaters</a>)</li><li><code>isd</code>: initial state distribution</li><li><code>s</code>: initial state</li></ul><p>The last three of these inputs are optional. If they are not explicitly provided, they should be inferred using the following POMDPs.jl functions:</p><ul><li><code>up =</code><a href="../api/#POMDPs.updater"><code>updater</code></a><code>(policy)</code></li><li><code>isd =</code><a href="../api/#POMDPs.initialstate"><code>initialstate</code></a><code>(pomdp)</code></li><li><code>s =</code>rand(rng, <a href="../api/#POMDPs.initialstate"><code>initialstate</code></a><code>(pomdp))</code></li></ul><p>In addition, a random number generator <code>rng</code> is assumed to be available.</p><h3 id="Simulation-Loop"><a class="docs-heading-anchor" href="#Simulation-Loop">Simulation Loop</a><a id="Simulation-Loop-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Loop" title="Permalink"></a></h3><p>The main simulation loop is shown below. Note that the <a href="../api/#POMDPs.isterminal"><code>isterminal</code></a> check prevents any actions from being taken and reward from being collected from a terminal state.</p><p>Before the loop begins, <a href="../api/#POMDPs.initialize_belief"><code>initialize_belief</code></a> is called to create the <a href="../concepts/#Beliefs-and-Updaters">belief</a> based on the initial state distribution - this is especially important when the belief is solver specific, such as the finite-state-machine used by MCVI. </p><pre><code class="language-julia">b = initialize_belief(up, isd)

r_total = 0.0
d = 1.0
while !isterminal(pomdp, s)
    a = action(policy, b)
    s, o, r = gen(DDNOut(:sp,:o,:r), pomdp, s, a, rng)
    r_total += d*r
    d *= discount(pomdp)
    b = update(up, b, a, o)
end</code></pre><p>In terms of the explicit interface, <a href="../api/#POMDPs.gen"><code>gen</code></a> above can be expressed as:</p><pre><code class="language-julia">function gen(::DDNOut{(:sp,:o,:r)}, pomdp, s, a, rng)
    sp = rand(rng, transition(pomdp, s, a))
    o = rand(rng, observation(pomdp, s, a, sp))
    r = reward(pomdp, s, a, sp)
    return sp, o, r
end</code></pre><h2 id="MDP-Simulation"><a class="docs-heading-anchor" href="#MDP-Simulation">MDP Simulation</a><a id="MDP-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#MDP-Simulation" title="Permalink"></a></h2><h3 id="Inputs-2"><a class="docs-heading-anchor" href="#Inputs-2">Inputs</a><a class="docs-heading-anchor-permalink" href="#Inputs-2" title="Permalink"></a></h3><p>In general, MDP simulations take up to 3 inputs (see also the <a href="../api/#POMDPs.simulate"><code>simulate</code></a> docstring):</p><ul><li><code>mdp::MDP</code>: mdp model object (see <a href="../concepts/#POMDPs-and-MDPs">POMDPs and MDPs</a>)</li><li><code>policy::Policy</code>: policy (see <a href="../concepts/#Solvers-and-Policies">Solvers and Policies</a>)</li><li><code>s</code>: initial state</li></ul><p>The last of these inputs is optional. If the initial state is not explicitly provided, it should be generated using</p><ul><li><code>s =</code><a href="../api/#POMDPs.initialstate"><code>initialstate</code></a><code>(mdp, rng)</code></li></ul><p>In addition, a random number generator <code>rng</code> is assumed to be available.</p><h3 id="Simulation-Loop-2"><a class="docs-heading-anchor" href="#Simulation-Loop-2">Simulation Loop</a><a class="docs-heading-anchor-permalink" href="#Simulation-Loop-2" title="Permalink"></a></h3><p>The main simulation loop is shown below. Note again that the <a href="../api/#POMDPs.isterminal"><code>isterminal</code></a> check prevents any actions from being taken and reward from being collected from a terminal state.</p><pre><code class="language-julia">r_total = 0.0
disc = 1.0
while !isterminal(mdp, s)
    a = action(policy, s)
    s, r = gen(DDNOut(:sp,:r), mdp, s, a, rng)
    r_total += d*r
    d *= discount(mdp)
end</code></pre><p>In terms of the explicit interface, <a href="../api/#POMDPs.gen"><code>gen</code></a> above can be expressed as:</p><pre><code class="language-julia">function gen(::DDNOut{(:sp,:r)}, mdp, s, a, rng)
    sp = rand(rng, transition(pomdp, s, a))
    r = reward(pomdp, s, a, sp)
    return sp, r
end</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../def_updater/">« Defining a Belief Updater</a><a class="docs-footer-nextpage" href="../run_simulation/">Running Simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 22 December 2020 02:02">Tuesday 22 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
